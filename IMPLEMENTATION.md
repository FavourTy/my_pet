# My Pet - Virtual Pet Game

A Flutter-based virtual pet game with AI features, time-based mechanics, and room customization.

## Features Implemented

### Phase 1: Localization (English/Japanese Support)

The app now supports both English and Japanese languages:

- **Location**: `lib/l10n/`
- **Files**: 
  - `app_en.arb` - English translations
  - `app_ja.arb` - Japanese translations
  - `l10n.yaml` - Localization configuration

**How it works:**
- Localization is automatically generated by Flutter
- The app detects system language and displays appropriate translations
- All UI strings are now externalized and localizable

**Usage:**
The system will automatically use the device's language setting. To test different languages, change your device/emulator language settings.

### Phase 2: Core Mechanics (MVP)

#### 1. Room & Pet Engine

**Rooms Screen** (`lib/screens/rooms_screen.dart`):
- View all your rooms with furniture count and plant status
- Create new rooms (limited by room quota)
- Navigate to room details for customization
- Track room quota usage

**Room Detail View**:
- Interactive room with time-based sky gradient (day/night cycle)
- Draggable furniture placement using `Stack` and `Positioned` widgets
- Add furniture and plants dynamically
- Visual feedback for withered plants
- Real-time water level indicators for plants

**Key Features:**
- Furniture items can be dragged to any position (x, y coordinates)
- Plants show water level bars
- Sky darkens based on time of day
- Tap plants to water them

#### 2. Time-Based Logic (Wither System)

**Implementation** (`lib/services/time_service.dart`):

The time service automatically:
- Updates every minute to check for hour/day changes
- Calculates sky darkness (0.0 = day, 1.0 = night)
- Manages plant water levels (decrease over time)
- Updates pet moods based on time since last fed/played

**Wither System:**
- **Flowers**: Wither after 24 hours without water (waterLevel reaches 0)
- **Pets**: Get hungry after 4 hours without food
- **Sky**: Darkens progressively from 6 PM to 8 PM, fully dark 8 PM - 4 AM

**How to Test:**
The time-based features run automatically. To see faster updates:
1. Check plant water levels - they decrease by 2% per hour
2. Sky gradient changes based on device time
3. Pet mood updates based on last fed/played timestamps

### Phase 3: AI Features (Paid Users Only)

#### 1. AI Pet Creation

**Screen**: `lib/screens/ai_pet_creation_screen.dart`

**Features:**
- Create unique pets using Google Gemini AI
- Generate detailed pet descriptions based on:
  - Pet name
  - Pet type (dog, cat, other)
  - Appearance preferences
  - Personality traits
- Generate image prompts for use with DALL-E/Midjourney
- Restricted to paid members only

**How to Use:**
1. Navigate to AI Pet Creation screen (add route in your UI)
2. Fill in pet details
3. Click "Generate with AI"
4. First-time users will be prompted to enter their Gemini API key
5. AI generates a unique description and image prompt

**API Key Setup:**
- Get a free API key from [Google AI Studio](https://ai.google.dev)
- Enter the key when prompted in the app
- The key is stored for the session

#### 2. Educational AI

**Screen**: `lib/screens/ai_education_screen.dart`

**Features:**
Three tabs with different AI-powered features:

1. **Ask Advice Tab**:
   - Ask questions about pet care
   - Get personalized advice based on your pet's current state
   - Expert trainer persona for high-quality responses

2. **Training Videos Tab**:
   - Get personalized training video recommendations
   - Based on pet's age, type, and current mood
   - 5 recommended topics per request

3. **Behavior Analysis Tab**:
   - Analyze your pet's current behavior
   - Get insights based on HP, mood, feeding, and play history
   - Suggestions for improvement

**How to Use:**
1. Navigate to AI Education screen
2. Select desired tab
3. For advice: Enter your question and click "Get Advice"
4. For videos: Click "Get Recommendations"
5. For analysis: Click "Analyze Behavior"

**AI Service** (`lib/services/ai_service.dart`):
- Uses Google Gemini Pro model
- Implements prompt engineering for consistent, helpful responses
- Error handling for API failures
- Initialization check before use

## Project Structure

```
lib/
├── l10n/                    # Localization files
│   ├── app_en.arb          # English translations
│   └── app_ja.arb          # Japanese translations
├── models/                  # Data models
│   ├── pet.dart            # Pet model with mood, HP, age
│   ├── room.dart           # Room model with furniture & plants
│   ├── user.dart           # User model with membership
│   ├── item.dart           # Item model
│   └── event.dart          # Event model
├── services/               # Business logic services
│   ├── ai_service.dart     # AI integration (Gemini)
│   ├── time_service.dart   # Time-based updates
│   └── ...
├── screens/                # UI screens
│   ├── home_screen.dart    # Main game screen
│   ├── rooms_screen.dart   # Room management
│   ├── ai_pet_creation_screen.dart  # AI pet creation
│   └── ai_education_screen.dart     # Educational AI
├── providers/              # State management
│   └── app_state_provider.dart
└── widgets/                # Reusable widgets
```

## Dependencies

Key packages used:
- `flutter_localizations` - Internationalization support
- `google_generative_ai` - Google Gemini AI integration
- `provider` - State management
- `go_router` - Navigation
- `flutter_animate` - Animations
- `intl` - Date/time formatting

## Setup Instructions

### 1. Install Dependencies

```bash
flutter pub get
```

### 2. Generate Localization Files

```bash
flutter gen-l10n
```

This generates the localization code from the ARB files.

### 3. Get a Gemini API Key (for AI features)

1. Go to [Google AI Studio](https://ai.google.dev)
2. Sign in with your Google account
3. Click "Get API Key"
4. Copy your API key
5. Enter it in the app when prompted to use AI features

### 4. Run the App

```bash
flutter run
```

## Testing

### Localization
- Change device language between English and Japanese
- Verify all UI text updates accordingly

### Time-Based Features
- Check plant water levels decrease over time
- Verify sky gradient changes with time of day
- Test pet mood updates

### AI Features
1. **AI Pet Creation**:
   - Test with different pet types
   - Try various appearance/personality combinations
   - Verify paid member restriction

2. **Educational AI**:
   - Ask various pet care questions
   - Get training video recommendations
   - Analyze pet behavior at different states

### Room Management
- Create new rooms (test quota limits)
- Add furniture and plants
- Drag furniture to reposition
- Water plants and verify water level updates

## Design Considerations

### Responsive Design
- Uses flexible layouts with `Stack`, `Positioned`, and `Column`/`Row`
- Adapts to different screen sizes
- Touch-friendly interactive elements

### Performance
- Efficient state updates with Provider
- Minimal rebuilds with Consumer widgets
- Lazy loading where applicable

### User Experience
- Clear visual feedback for all actions
- Loading states for AI operations
- Error handling with user-friendly messages
- Smooth animations and transitions

## Future Enhancements

Based on the original spec, future features could include:
- Integration with DALL-E for actual AI image generation
- Real-time multiplayer plaza features
- Gacha system enhancements
- Training video library with actual content
- Social features (friends, DM)
- Pet loss support community
- Subscription payment integration
- More room customization options
- Pet clothing/outfits system

## Notes

- AI features require an active internet connection
- Gemini API key needed for AI features (free tier available)
- Time-based features work automatically in background
- Room quota can be expanded (future: link to subscription)

## License

This is a demo project for educational purposes.
